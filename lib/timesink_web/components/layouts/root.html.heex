<!DOCTYPE html>
<html lang="en" class="[scrollbar-gutter:stable] bg-backroom-black" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content={get_csrf_token()} />

    <meta
      name="description"
      content="We bring great filmmakers — of all levels — to the stage. And we don’t waste your time discovering them. Real audiences. Real-time reactions. Conversations and moments that last. No noise — pure signal."
    />

    <.live_title suffix=" · Real audiences. Real time. Real cinema.">
      {assigns[:page_title] || "TimeSink Presents"}
    </.live_title>
    
<!-- ✅ FAVICONS -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="TimeSink" />
    <link rel="manifest" href="/site.webmanifest" />

    <link phx-track-static rel="stylesheet" href={~p"/fonts/ano/ano.css"} />
    <link
      phx-track-static
      rel="stylesheet"
      href={~p"/fonts/gangster_grotesk/gangster-grotesk.css"}
    />
    <link phx-track-static rel="stylesheet" href={~p"/assets/app.css"} />
    
<!-- JS -->
    <script defer phx-track-static type="text/javascript" src={~p"/assets/app.js"}>
    </script>
  </head>

  <body class="text-mystery-white font-gangster antialiased">
    {@inner_content}
    <script>
      // Back/Forward Cache (bfcache) Optimization
      //
      // Browsers cache pages when navigating away to enable instant back/forward navigation.
      // However, open WebSocket connections (used by LiveView) can prevent this caching.
      //
      // This script:
      // 1. Disconnects LiveSocket when page is hidden (pagehide) - signals browser it's safe to cache
      // 2. Reconnects LiveSocket when page is restored (pageshow) - restores live functionality
      // 3. Only runs if event.persisted=true (meaning page was restored from bfcache)
      //
      // Result: Instant back/forward navigation + maintained LiveView functionality
      window.addEventListener('pagehide', (event) => {
        if (event.persisted && window.liveSocket) {
          window.liveSocket.disconnect();
        }
      });

      window.addEventListener('pageshow', (event) => {
        if (event.persisted && window.liveSocket) {
          window.liveSocket.connect();
        }
      });
    </script>
  </body>
</html>
